# Update NodeJs

> brew update
> brew upgrade node
> node -v


# create expo app
> npx create-expo-app --template blank HabitTracker
> cd HabitTracker
> npm start

> npm run ios
> npm run android
> npm run web

# install xcode from AppStore
# pin Simulator.app


# install NativeWind
> npx expo install babel-preset-expo
> npx expo install react-native-worklets

Then do these steps
> https://www.nativewind.dev/docs/getting-started/installation





================================= Build & Deploying the app ====================================

ToCheck
1 - Permissions: Define permission request text
2 - App name and Identifier - set up visible app name, app version, unique app id
3 - Env vars - expo can manage env vars like API Keys
4 - Icon and splash screen
5 - Privacy Policy 
	- In app Settings > Privacy Policy
	- Public URL (Github pages)
6 - Generate certs inside Apple Developer Dashboard
	- iOS Distribution cert
	- Create a app on App Store Connect
	- Provisioning profile
7 - 
	- Up to 3 app previews and 10 screenshots here
	- only the first 3 will be used on the app installation sheets
	- 1242 Ã— 2688px


Use "Expo Application Services"
https://docs.expo.dev/


Update app.json
- set Name, Slug, ios.buildNumber... etc


Create Icons / Splash Icon
- 1024 x 1024 	- for both icon and splash screen icon
- 48x48  		- for favicon


Install EAS cli
> npm install -g eas-cli


EAS build (start)
- https://docs.expo.dev/build/introduction/

> eas login
> eas build:configure      =>   adds an eas.json file to the project


EAS build (Create a simulator build for ios)
# in eas.json set => preview.ios.simulator:true
> eas build -p ios --profile preview
# then pick an ios bundle identifier



Generate "iOS Distribution cert"
- Go to https://developer.apple.com/account
- Go to certificates > certificates
- Upload existing cert or create a new one (click Learn More)
- Click continue
- Download the certificates from that screen

- create a sub folder /certs/ios in the app repo
- upload the certs there
- add certs to .gitignore


Create a app on App Store Connect
- Go to https://developer.apple.com/account
- Go to Apps > Add Apps
	- Add a Name (Habit Tracker & Reminders)
	- Pick platforms - ios
	- Pick Bundle Id 
		> Register a new bundle id -> use from app.json "bundleIdentifier" field
		> Select app Capabilities (ex: push notifications)
		- click Continue
		- click Register
	- add SKU (ex: HabitApp OR com.rahalrsh.....) - this is an internal name
	- User Access > Full Access
	- Create


Generate Provisioning profile
- Go to https://developer.apple.com/account
- Go to certificates > profiles
- Click Create Profile
- Pick Distribution > App Store Connect option
- continue
- Pick Select an App ID
- continue
- Select Distribution Certificate created before (*.cer)
- continue
- Add a Provisioning profile name (ex: Habit App)
- Generate Profile
- Download the Profile

- go to sub folder /certs/ios in the app repo
- upload the Profile there


Execute the certificate file in /certs/ios/*.cer (so it gets added to KeyChain)
- Open in Finder
- Double click *.cer 
- Selecet - KeyChain: iCloud
- Click Add (add to keychain)
- in keychain > search for that cert
- go to my certificates
- Right click > export as a .p12 file to /certs/ios
- Make sure to set a password


Now we have 3 files in /certs/ios
Make EAS aware of those files (Follow: https://docs.expo.dev/app-signing/local-credentials/)
 - credentials.json file at the root
 - add the below to credentials.json
 - Make sure to REPLACE ***** with correct file names & password
 {
  "ios": {
    "provisioningProfilePath": "certs/ios/*****.mobileprovision",
    "distributionCertificate": {
      "path": "certs/ios/*****.p12",
      "password": "/*****"
    }
  }
}

Force EAS to use the local credentials.json file
- in eas.json > build.production  >   "credentialsSource": "local"



EAS build (Create a Production build for ios)
> eas build -p ios
# login to apple account
# this will generate a build file (.ipa) locally


Upload this build file to App store connect (this will just upload the file, wont pubish to App Store Yet)
> eas submit -p ios --path /path/to/your-app.ipa













